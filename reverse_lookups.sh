#!/bin/bash

#https://github.com/Plotkine/Pentesting

#Description

#colors: white=\e[97m red=\e[91m green=\e[92m light grey=\e[37m
#fonts: normal= \033[0m bold=\033[1m

# CHECKS

#number of parameters check
if (( $#<1 || $#>1 ))
then
        echo -e "\e[92mUsage:\e[97m bash reverse_lookups.sh [DNS server] [network address] [network mask]" #green
        #echo -e "- URL        target website, with valid PHP parameter"
        #echo -e "\e[37m- URL        = target website, with valid PHP parameter" #light grey
        #echo -e "- query      DBMS field queried"
        #echo -e "- maxlength  number of chars to be extracted from the query"
        #echo -e "- truestring webpage output when the SQL query returns true" #\e[97m"
        #echo -e ""
        echo -e "\e[92mExample: bash reverse_lookups.sh 172.16.5.31 172.16.5.0 255.255.255.0" #green
        #echo -e "                bash blind_sqli.sh http://target.site?id=1 \"Select user()\" 5 \"Image found\""
        #echo -e "                bash blind_sqli.sh http://target.site?id=1 \"Select database()\" 5 \"Image found\""
        exit 0
fi

export DNSServer=$1

for i in {1..99}
do
        export output=`sudo dig @$DNSServer -x 172.16.5.$i +nocookie |grep PTR |cut -d"R" -f2`
        if [ "$output" != "" ]
        then
                echo "172.16.5.$i:"
	        echo "$output"
        fi
done
