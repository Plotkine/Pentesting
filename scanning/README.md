Description:
- script to automate port scanning and service enumeration.

Initialization:
- add the dirsearch directory to the PATH environment variable: **PATH=$PATH:/path/to/dirsearch/directory**
- make the script executable: **chmod +x scan_script**

Usage:
- put your targets in hosts_list.txt (one per line; **I RECOMMEND LESS THAN 6 TARGETS** to avoid too much CPU load)
- in one terminal: **sudo ./scan_script hosts_list.txt**
- in another terminal: **watch -n1 "cat 0000-----RUNNING-TASKS-----0000"**
- to properly kill the process before it finishes: **sudo pkill -f scan_script**
- if you want to relaunch the script make sure that the folder for each target is removed in current directory

Commands run:
- nmap -sS -p- <IP> --reason -Pn -n
- nmap -sU -A <IP> --reason --top-ports=20 -Pn -n
- nmap -sTCV --version-all -p <open TCP ports> <IP> -Pn -n
- nmap -sUCV --version-all -p <open UDP ports> <IP> -Pn -n
- nmap -sT -sU -A --osscan-guess <IP> -p <open TCP & UDP ports> -Pn -n
- nmap -sT --script +vuln -p <open TCP ports> <IP> -Pn -n
- for all open TCP ports:
  - nc -nvvC <IP> <port> -w 60, and send random packets
- for all open UDP ports:
  - nc -nvvC -u <IP> <port> -w 60, and send random packets
- if port 139 or port 445 open:
  - enum4linux -v <IP>, smbclient -L\\ -N -I <IP>
- if port 445 open:
  - smbmap -u null -p "" -H <IP> -P 445
  - for each share IPC$, C$, Admin$^:
    - smbclient //<IP>/<share> -N -p445 -q15 -c 'dir'
- if port 139 open:
  - smbmap -u null -p "" -H <IP> -P 139
  - for each share IPC$, C$, Admin$^:
    - smbclient //<IP>/<share> -N -p139 -q15 -c 'dir'
- for each open http port:
  - dirsearch.py -u http://<IP>:<port>/ -e "txt,html,php,asp,aspx,jsp,bak,old,cgi" -w /usr/share/seclists/Discovery/Web-Content/common.txt -r -t 100 -F -R 2 -f
  - dirsearch.py -u http://<IP>:<port>/ -e "txt,html,php,asp,aspx,jsp,bak,old,cgi" -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 100 -F -f
  - nikto -ask=no -h http://<IP>:<port>/
- for each open https port:
  - gobuster dir -x "txt,html,php,asp,aspx,jsp,bak,old,cgi" -r -k -u https://<IP>:<port>/ -z -q -t 100 -v -w /usr/share/seclists/Discovery/Web-Content/common.txt
  - gobuster dir -x "txt,html,php,asp,aspx,jsp,bak,old,cgi" -r -k -u https://<IP>:<port>/ -z -q -t 100 -v -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
  - nikto -ask=no -h https://<IP>:<port>/
