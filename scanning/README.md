Description: script to automate port scanning and services enumeration.

Requirements
- nmap
- netcat
- enum4linux
- smbclient
- smbmap
- dirsearch
- gobuster
- nikto

Initialization:
- make the script executable: **chmod +x scan_script**
- put dirsearch folder in /home/kali/Desktop/

Usage:
- put your targets in hosts_list.txt (one per line; **I RECOMMEND LESS THAN 6 TARGETS** to avoid too much CPU load)
- in one terminal: **sudo ./scan_script hosts_list.txt**
- in another terminal: **watch -n1 "cat 0000-----RUNNING-TASKS-----0000"**
- to properly kill the process before it finishes: **sudo pkill -f scan_script**
- if you want to relaunch the script make sure that the folder for each target is removed in current directory

Commands run by the script:
- nmap -sS -T4 -p- IP --reason -Pn -n
- nmap -sU -A -T4 IP --reason --top-ports=20 -Pn -n
- nmap -sTCV --version-all -T4 -p OPEN_TCP_PORTS IP -Pn -n
- nmap -sUCV --version-all -T4 -p OPEN_UDP_PORTS IP -Pn -n
- nmap -sT -sU -A --osscan-guess -T4 IP -p T:OPEN_TCP_PORTS,666,U:OPEN_UDP_PORTS -Pn -n
- nmap -sT --script +vuln -T4 -p OPEN_TCP_PORTS IP -Pn -n
- for all open TCP ports:
  - nc -nvvC IP PORT -w 60, and send random packets
- for all open UDP ports:
  - nc -nvvC -u IP PORT -w 60, and send random packets
- if port 139 or port 445 open:
  - enum4linux -v IP
  - smbclient -L\\ -N -I IP
- if port 445 open:
  - smbmap -u null -p "" -H IP -P 445
  - for each share IPC$, C$, Admin$^:
    - smbclient //IP/SHARE -N -p445 -q15 -c 'dir'
- if port 139 open:
  - smbmap -u null -p "" -H IP -P 139
  - for each share IPC$, C$, Admin$^:
    - smbclient //IP/SHARE -N -p139 -q15 -c 'dir'
- for each open http port:
  - dirsearch.py -u http://IP:PORT/ -e "txt,html,php,asp,aspx,jsp,bak,old,cgi" -w /usr/share/seclists/Discovery/Web-Content/common.txt -r -t 100 -F -R 2 -f
  - dirsearch.py -u http://IP:PORT/ -e "txt,html,php,asp,aspx,jsp,bak,old,cgi" -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 100 -F -f
  - nikto -ask=no -h http://IP:PORT/
- for each open https port:
  - gobuster dir -x "txt,html,php,asp,aspx,jsp,bak,old,cgi" -r -k -u https://IP:PORT/ -z -q -t 100 -v -w /usr/share/seclists/Discovery/Web-Content/common.txt
  - gobuster dir -x "txt,html,php,asp,aspx,jsp,bak,old,cgi" -r -k -u https://IP:PORT/ -z -q -t 100 -v -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
  - nikto -ask=no -h https://IP:PORT/
