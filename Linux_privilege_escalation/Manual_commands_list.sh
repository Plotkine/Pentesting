# Hostname: may reveal the function of the machine
# 
# OS version/architecture: kernel exploits
# 
# Processes: processes running as root may be of interest if they contain vulnerabilities
# 
# Network/Firewall: could reveal other networks to pivot to could reveal port bindings on local machine that were not accessible by scanning firewall rules can facilitate port forwarding/tunneling if we know which inbound/outbound ports are filtered
# 
# Scheduled tasks: we want to check here for insecure file permissions
# 
# Installed applications/patch level: we want to find vulnerable applications that could lead to privesc/when the system has been last patched
# 
# Readable/Writable files & directories: looking to modify scripts or binaries executed under context of privileged account also sensitive files containing hard-coded credentials
# 
# Unmounted Disks: not all drives are mounted at boot => we should look for unmounted drives we might want to mount unmounted partitions to search for interesting documents/credentials/...
# 
# Device drivers/Kernel modules: get drivers/drivers versions/kernel version to look for exploits
# 
# Binaries That AutoElevate: if we can run a binary that is autoelevating we could craft one or use it to elevate

#####################################################################################

#---Users
id
cat /etc/passwd #other users
                #the services listed are those using that particular user to run

#---Hostname
hostname

#---OS version/architecture
cat /etc/issue     #OS version
cat /etc/*-release #OS version
uname -a           #Kernel version/Architecture

#---Processes
ps aux #ax = processes with or without a tty
       #u  = user-readable format

#---Network/Firewall
ifconfig a #a = all
ip a       #equivalent
/sbin/route #routing table
            #try routel if it doesn't work
ss -anp #a = all connections
        #n = avoid hostname resolution
        #p = process names
        #similar to netstat
#on linux we need root privileges to display firewall rules with iptables
search /etc/iptables on debian
in general, search /etc and/or grep for iptables commands in the filesystem ("iptables-save", "iptables-restore")
#e.g. a service may be accessible only on the loopback address

#---Scheduled tasks
Two locations:
- /etc/cron.* where * is the frequency of the task
- /etc/crontab where system admins often add their own scheduled tasks (=> juicy because will often run as root!)

ls -lah /etc/cron*

#---Installed applications/patch level
dpkg -l #lists applications

#---Readable/Writable files & directories
find / -writable -type d 2>/dev/null #-type d for directories

#---Unmounted drives
cat /etc/fstab #lists drives mounted at boot time
               #note that admins might have used custom config/scripts to mount drives not listed in /etc/fstab
mount      #list all mounted filesystems
/bin/lsblk #list available disks

#---Device drivers/Kernel modules
lsmod #lists kernel modules
/sbin/modinfo libata #get "libata" module version (this is an example)

#---Binaries That AutoElevate
find / -perm -u=s -type f 2>/dev/null #find SUID binaries
                                      #-u=s: SUID bit set
